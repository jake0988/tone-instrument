{"ast":null,"code":"import { Gain } from \"../../core/context/Gain\";\nimport { Param } from \"../../core/context/Param\";\nimport { connectSeries, ToneAudioNode } from \"../../core/context/ToneAudioNode\";\nimport { optionsFromArguments } from \"../../core/util/Defaults\";\nimport { readOnly } from \"../../core/util/Interface\";\nimport { ToneAudioWorklet } from \"../../core/worklet/ToneAudioWorklet\";\nimport { workletName } from \"./FeedbackCombFilter.worklet\";\n/**\n * Comb filters are basic building blocks for physical modeling. Read more\n * about comb filters on [CCRMA's website](https://ccrma.stanford.edu/~jos/pasp/Feedback_Comb_Filters.html).\n *\n * This comb filter is implemented with the AudioWorkletNode which allows it to have feedback delays less than the\n * Web Audio processing block of 128 samples. There is a polyfill for browsers that don't yet support the\n * AudioWorkletNode, but it will add some latency and have slower performance than the AudioWorkletNode.\n * @category Component\n */\n\nexport class FeedbackCombFilter extends ToneAudioWorklet {\n  constructor() {\n    super(optionsFromArguments(FeedbackCombFilter.getDefaults(), arguments, [\"delayTime\", \"resonance\"]));\n    this.name = \"FeedbackCombFilter\";\n    const options = optionsFromArguments(FeedbackCombFilter.getDefaults(), arguments, [\"delayTime\", \"resonance\"]);\n    this.input = new Gain({\n      context: this.context\n    });\n    this.output = new Gain({\n      context: this.context\n    });\n    this.delayTime = new Param({\n      context: this.context,\n      value: options.delayTime,\n      units: \"time\",\n      minValue: 0,\n      maxValue: 1,\n      param: this._dummyParam,\n      swappable: true\n    });\n    this.resonance = new Param({\n      context: this.context,\n      value: options.resonance,\n      units: \"normalRange\",\n      param: this._dummyParam,\n      swappable: true\n    });\n    readOnly(this, [\"resonance\", \"delayTime\"]);\n  }\n\n  _audioWorkletName() {\n    return workletName;\n  }\n  /**\n   * The default parameters\n   */\n\n\n  static getDefaults() {\n    return Object.assign(ToneAudioNode.getDefaults(), {\n      delayTime: 0.1,\n      resonance: 0.5\n    });\n  }\n\n  onReady(node) {\n    connectSeries(this.input, node, this.output);\n    const delayTime = node.parameters.get(\"delayTime\");\n    ;\n    this.delayTime.setParam(delayTime);\n    const feedback = node.parameters.get(\"feedback\");\n    ;\n    this.resonance.setParam(feedback);\n  }\n\n  dispose() {\n    super.dispose();\n    this.input.dispose();\n    this.output.dispose();\n    this.delayTime.dispose();\n    this.resonance.dispose();\n    return this;\n  }\n\n}","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,QAAqB,yBAArB;AACA,SAASC,KAAT,QAAsB,0BAAtB;AACA,SAASC,aAAT,EAAwBC,aAAxB,QAAmE,kCAAnE;AAEA,SAASC,oBAAT,QAAqC,0BAArC;AACA,SAASC,QAAT,QAA2C,2BAA3C;AACA,SAASC,gBAAT,QAAiC,qCAAjC;AACA,SAASC,WAAT,QAA4B,8BAA5B;AAOA;;;;;;;;;;AASA,OAAM,MAAOC,kBAAP,SAAkCF,gBAAlC,CAA6E;EAuBlFG;IACC,MAAML,oBAAoB,CAACI,kBAAkB,CAACE,WAAnB,EAAD,EAAmCC,SAAnC,EAA8C,CAAC,WAAD,EAAc,WAAd,CAA9C,CAA1B;IAtBQ,YAAO,oBAAP;IAuBR,MAAMC,OAAO,GAAGR,oBAAoB,CAACI,kBAAkB,CAACE,WAAnB,EAAD,EAAmCC,SAAnC,EAA8C,CAAC,WAAD,EAAc,WAAd,CAA9C,CAApC;IAEA,KAAKE,KAAL,GAAa,IAAIb,IAAJ,CAAS;MAAEc,OAAO,EAAE,KAAKA;IAAhB,CAAT,CAAb;IACA,KAAKC,MAAL,GAAc,IAAIf,IAAJ,CAAS;MAAEc,OAAO,EAAE,KAAKA;IAAhB,CAAT,CAAd;IAEA,KAAKE,SAAL,GAAiB,IAAIf,KAAJ,CAAkB;MAClCa,OAAO,EAAE,KAAKA,OADoB;MAElCG,KAAK,EAAEL,OAAO,CAACI,SAFmB;MAGlCE,KAAK,EAAE,MAH2B;MAIlCC,QAAQ,EAAE,CAJwB;MAKlCC,QAAQ,EAAE,CALwB;MAMlCC,KAAK,EAAE,KAAKC,WANsB;MAOlCC,SAAS,EAAE;IAPuB,CAAlB,CAAjB;IAUA,KAAKC,SAAL,GAAiB,IAAIvB,KAAJ,CAAyB;MACzCa,OAAO,EAAE,KAAKA,OAD2B;MAEzCG,KAAK,EAAEL,OAAO,CAACY,SAF0B;MAGzCN,KAAK,EAAE,aAHkC;MAIzCG,KAAK,EAAE,KAAKC,WAJ6B;MAKzCC,SAAS,EAAE;IAL8B,CAAzB,CAAjB;IAQAlB,QAAQ,CAAC,IAAD,EAAO,CAAC,WAAD,EAAc,WAAd,CAAP,CAAR;EACA;;EAESoB,iBAAiB;IAC1B,OAAOlB,WAAP;EACA;EAED;;;;;EAGkB,OAAXG,WAAW;IACjB,OAAOgB,MAAM,CAACC,MAAP,CAAcxB,aAAa,CAACO,WAAd,EAAd,EAA2C;MACjDM,SAAS,EAAE,GADsC;MAEjDQ,SAAS,EAAE;IAFsC,CAA3C,CAAP;EAIA;;EAEDI,OAAO,CAACC,IAAD,EAAuB;IAC7B3B,aAAa,CAAC,KAAKW,KAAN,EAAagB,IAAb,EAAmB,KAAKd,MAAxB,CAAb;IACA,MAAMC,SAAS,GAAGa,IAAI,CAACC,UAAL,CAAgBC,GAAhB,CAAoB,WAApB,CAAlB;IAAiE;IACjE,KAAKf,SAAL,CAAegB,QAAf,CAAwBhB,SAAxB;IACA,MAAMiB,QAAQ,GAAGJ,IAAI,CAACC,UAAL,CAAgBC,GAAhB,CAAoB,UAApB,CAAjB;IAA+D;IAC/D,KAAKP,SAAL,CAAeQ,QAAf,CAAwBC,QAAxB;EACA;;EAEDC,OAAO;IACN,MAAMA,OAAN;IACA,KAAKrB,KAAL,CAAWqB,OAAX;IACA,KAAKnB,MAAL,CAAYmB,OAAZ;IACA,KAAKlB,SAAL,CAAekB,OAAf;IACA,KAAKV,SAAL,CAAeU,OAAf;IACA,OAAO,IAAP;EACA;;AAhFiF","names":["Gain","Param","connectSeries","ToneAudioNode","optionsFromArguments","readOnly","ToneAudioWorklet","workletName","FeedbackCombFilter","constructor","getDefaults","arguments","options","input","context","output","delayTime","value","units","minValue","maxValue","param","_dummyParam","swappable","resonance","_audioWorkletName","Object","assign","onReady","node","parameters","get","setParam","feedback","dispose"],"sources":["/Users/jakeg/code/tone-instrument/node_modules/tone/Tone/component/filter/FeedbackCombFilter.ts"],"sourcesContent":["import { Gain } from \"../../core/context/Gain\";\nimport { Param } from \"../../core/context/Param\";\nimport { connectSeries, ToneAudioNode, ToneAudioNodeOptions } from \"../../core/context/ToneAudioNode\";\nimport { NormalRange, Time } from \"../../core/type/Units\";\nimport { optionsFromArguments } from \"../../core/util/Defaults\";\nimport { readOnly, RecursivePartial } from \"../../core/util/Interface\";\nimport { ToneAudioWorklet } from \"../../core/worklet/ToneAudioWorklet\";\nimport { workletName } from \"./FeedbackCombFilter.worklet\";\n\nexport interface FeedbackCombFilterOptions extends ToneAudioNodeOptions {\n\tdelayTime: Time;\n\tresonance: NormalRange;\n}\n\n/**\n * Comb filters are basic building blocks for physical modeling. Read more\n * about comb filters on [CCRMA's website](https://ccrma.stanford.edu/~jos/pasp/Feedback_Comb_Filters.html).\n * \n * This comb filter is implemented with the AudioWorkletNode which allows it to have feedback delays less than the \n * Web Audio processing block of 128 samples. There is a polyfill for browsers that don't yet support the \n * AudioWorkletNode, but it will add some latency and have slower performance than the AudioWorkletNode. \n * @category Component\n */\nexport class FeedbackCombFilter extends ToneAudioWorklet<FeedbackCombFilterOptions> {\n\n\treadonly name = \"FeedbackCombFilter\";\n\n\t/**\n\t * The amount of delay of the comb filter.\n\t */\n\treadonly delayTime: Param<\"time\">;\n\n\t/**\n\t * The amount of feedback of the delayed signal.\n\t */\n\treadonly resonance: Param<\"normalRange\">;\n\n\treadonly input: Gain;\n\treadonly output: Gain;\n\n\t/**\n\t * @param delayTime The delay time of the filter.\n\t * @param resonance The amount of feedback the filter has.\n\t */\n\tconstructor(delayTime?: Time, resonance?: NormalRange);\n\tconstructor(options?: RecursivePartial<FeedbackCombFilterOptions>);\n\tconstructor() {\n\t\tsuper(optionsFromArguments(FeedbackCombFilter.getDefaults(), arguments, [\"delayTime\", \"resonance\"]));\n\t\tconst options = optionsFromArguments(FeedbackCombFilter.getDefaults(), arguments, [\"delayTime\", \"resonance\"]);\n\n\t\tthis.input = new Gain({ context: this.context });\n\t\tthis.output = new Gain({ context: this.context });\n\n\t\tthis.delayTime = new Param<\"time\">({\n\t\t\tcontext: this.context,\n\t\t\tvalue: options.delayTime,\n\t\t\tunits: \"time\",\n\t\t\tminValue: 0,\n\t\t\tmaxValue: 1,\n\t\t\tparam: this._dummyParam,\n\t\t\tswappable: true,\n\t\t});\n\n\t\tthis.resonance = new Param<\"normalRange\">({\n\t\t\tcontext: this.context,\n\t\t\tvalue: options.resonance,\n\t\t\tunits: \"normalRange\",\n\t\t\tparam: this._dummyParam,\n\t\t\tswappable: true,\n\t\t});\n\n\t\treadOnly(this, [\"resonance\", \"delayTime\"]);\n\t}\n\n\tprotected _audioWorkletName(): string {\n\t\treturn workletName;\n\t}\n\n\t/**\n\t * The default parameters\n\t */\n\tstatic getDefaults(): FeedbackCombFilterOptions {\n\t\treturn Object.assign(ToneAudioNode.getDefaults(), {\n\t\t\tdelayTime: 0.1,\n\t\t\tresonance: 0.5,\n\t\t});\n\t}\n\n\tonReady(node: AudioWorkletNode) {\n\t\tconnectSeries(this.input, node, this.output);\n\t\tconst delayTime = node.parameters.get(\"delayTime\") as AudioParam;;\n\t\tthis.delayTime.setParam(delayTime);\n\t\tconst feedback = node.parameters.get(\"feedback\") as AudioParam;;\n\t\tthis.resonance.setParam(feedback);\n\t}\n\n\tdispose(): this {\n\t\tsuper.dispose();\n\t\tthis.input.dispose();\n\t\tthis.output.dispose();\n\t\tthis.delayTime.dispose();\n\t\tthis.resonance.dispose();\n\t\treturn this;\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}